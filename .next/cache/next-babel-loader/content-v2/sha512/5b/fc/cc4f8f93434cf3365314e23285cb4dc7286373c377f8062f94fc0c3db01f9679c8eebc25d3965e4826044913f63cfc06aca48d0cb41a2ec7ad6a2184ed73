{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"/Users/colechalland/Projects/ChalkCoin/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/colechalland/Projects/ChalkCoin/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/colechalland/Projects/ChalkCoin/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/colechalland/Projects/ChalkCoin/contexts/Bets.Context.js\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { createContext, useReducer, useEffect, useContext } from \"react\";\nimport axios from \"axios\";\nimport betsReducer from \"../reducers/Bets.Reducer\";\nimport { EventsFinder } from \"../helpers/EventsHelper\";\nimport { BlockchainDispatch } from \"./Blockchain.Context\";\nimport { getSession } from \"next-auth/client\";\nexport var BetContext = /*#__PURE__*/createContext();\nexport var BetDispatch = /*#__PURE__*/createContext();\nexport function BetProvider(props) {\n  _s();\n\n  var blockchainDispatch = useContext(BlockchainDispatch);\n\n  var _useReducer = useReducer(betsReducer, {\n    pendingBets: {\n      openBets: [],\n      recipientBets: []\n    },\n    acceptedBets: [],\n    completedBets: [],\n    initialized: false,\n    userBets: {}\n  }),\n      bets = _useReducer[0],\n      dispatch = _useReducer[1];\n\n  var completedAcceptedBets = bets.acceptedBets.map(function (sport) {\n    var _sport$bets;\n\n    return (_sport$bets = sport.bets) === null || _sport$bets === void 0 ? void 0 : _sport$bets.filter(function (bet) {\n      var _bet$event;\n\n      return ((_bet$event = bet.event) === null || _bet$event === void 0 ? void 0 : _bet$event.status.type.name) === \"STATUS_FINAL\";\n    });\n  }).flat();\n  var completedOpenBets = bets.pendingBets.openBets.map(function (sport) {\n    var _sport$bets2;\n\n    return (_sport$bets2 = sport.bets) === null || _sport$bets2 === void 0 ? void 0 : _sport$bets2.filter(function (bet) {\n      var _bet$event2;\n\n      return ((_bet$event2 = bet.event) === null || _bet$event2 === void 0 ? void 0 : _bet$event2.status.type.name) === \"STATUS_FINAL\";\n    });\n  }).flat();\n  var completedRecipientBets = bets.pendingBets.recipientBets.map(function (sport) {\n    var _sport$bets3;\n\n    return (_sport$bets3 = sport.bets) === null || _sport$bets3 === void 0 ? void 0 : _sport$bets3.filter(function (bet) {\n      var _bet$event3;\n\n      return ((_bet$event3 = bet.event) === null || _bet$event3 === void 0 ? void 0 : _bet$event3.status.type.name) === \"STATUS_FINAL\";\n    });\n  }).flat();\n  useEffect(function () {\n    function betEventFinder() {\n      return _betEventFinder.apply(this, arguments);\n    }\n\n    function _betEventFinder() {\n      _betEventFinder = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n        var betsData, userBets, session, userRes, res;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.next = 2;\n                return getSession();\n\n              case 2:\n                session = _context8.sent;\n                _context8.prev = 3;\n\n                if (!session) {\n                  _context8.next = 21;\n                  break;\n                }\n\n                _context8.next = 7;\n                return axios.get(\"/api/bets?type=currentUser\");\n\n              case 7:\n                userRes = _context8.sent;\n                userBets = userRes.data;\n                _context8.next = 11;\n                return Promise.all(userBets.pendingBets.openBets.map( /*#__PURE__*/function () {\n                  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(league) {\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            _context.next = 2;\n                            return EventsFinder(league, \"league\");\n\n                          case 2:\n                            return _context.abrupt(\"return\", _context.sent);\n\n                          case 3:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  }));\n\n                  return function (_x) {\n                    return _ref.apply(this, arguments);\n                  };\n                }()));\n\n              case 11:\n                userBets.pendingBets.openBets = _context8.sent;\n                _context8.next = 14;\n                return Promise.all(userBets.pendingBets.recipientBets.map( /*#__PURE__*/function () {\n                  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(league) {\n                    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            _context2.next = 2;\n                            return EventsFinder(league, \"league\");\n\n                          case 2:\n                            return _context2.abrupt(\"return\", _context2.sent);\n\n                          case 3:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2);\n                  }));\n\n                  return function (_x2) {\n                    return _ref2.apply(this, arguments);\n                  };\n                }()));\n\n              case 14:\n                userBets.pendingBets.recipientBets = _context8.sent;\n                _context8.next = 17;\n                return Promise.all(userBets.acceptedBets.map( /*#__PURE__*/function () {\n                  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(league) {\n                    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                      while (1) {\n                        switch (_context3.prev = _context3.next) {\n                          case 0:\n                            _context3.next = 2;\n                            return EventsFinder(league, \"league\");\n\n                          case 2:\n                            return _context3.abrupt(\"return\", _context3.sent);\n\n                          case 3:\n                          case \"end\":\n                            return _context3.stop();\n                        }\n                      }\n                    }, _callee3);\n                  }));\n\n                  return function (_x3) {\n                    return _ref3.apply(this, arguments);\n                  };\n                }()));\n\n              case 17:\n                userBets.acceptedBets = _context8.sent;\n                _context8.next = 20;\n                return Promise.all(userBets.completedBets.map( /*#__PURE__*/function () {\n                  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(league) {\n                    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                      while (1) {\n                        switch (_context4.prev = _context4.next) {\n                          case 0:\n                            _context4.next = 2;\n                            return EventsFinder(league, \"league\");\n\n                          case 2:\n                            return _context4.abrupt(\"return\", _context4.sent);\n\n                          case 3:\n                          case \"end\":\n                            return _context4.stop();\n                        }\n                      }\n                    }, _callee4);\n                  }));\n\n                  return function (_x4) {\n                    return _ref4.apply(this, arguments);\n                  };\n                }()));\n\n              case 20:\n                userBets.completedBets = _context8.sent;\n\n              case 21:\n                _context8.next = 23;\n                return axios.get(\"/api/bets?type=all\");\n\n              case 23:\n                res = _context8.sent;\n                betsData = res.data;\n                _context8.next = 27;\n                return Promise.all(betsData.pendingBets.openBets.map( /*#__PURE__*/function () {\n                  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(league) {\n                    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                      while (1) {\n                        switch (_context5.prev = _context5.next) {\n                          case 0:\n                            _context5.next = 2;\n                            return EventsFinder(league, \"league\");\n\n                          case 2:\n                            return _context5.abrupt(\"return\", _context5.sent);\n\n                          case 3:\n                          case \"end\":\n                            return _context5.stop();\n                        }\n                      }\n                    }, _callee5);\n                  }));\n\n                  return function (_x5) {\n                    return _ref5.apply(this, arguments);\n                  };\n                }()));\n\n              case 27:\n                betsData.pendingBets.openBets = _context8.sent;\n                _context8.next = 30;\n                return Promise.all(betsData.pendingBets.recipientBets.map( /*#__PURE__*/function () {\n                  var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(league) {\n                    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                      while (1) {\n                        switch (_context6.prev = _context6.next) {\n                          case 0:\n                            _context6.next = 2;\n                            return EventsFinder(league, \"league\");\n\n                          case 2:\n                            return _context6.abrupt(\"return\", _context6.sent);\n\n                          case 3:\n                          case \"end\":\n                            return _context6.stop();\n                        }\n                      }\n                    }, _callee6);\n                  }));\n\n                  return function (_x6) {\n                    return _ref6.apply(this, arguments);\n                  };\n                }()));\n\n              case 30:\n                betsData.pendingBets.recipientBets = _context8.sent;\n                _context8.next = 33;\n                return Promise.all(betsData.acceptedBets.map( /*#__PURE__*/function () {\n                  var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(league) {\n                    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n                      while (1) {\n                        switch (_context7.prev = _context7.next) {\n                          case 0:\n                            _context7.next = 2;\n                            return EventsFinder(league, \"league\");\n\n                          case 2:\n                            return _context7.abrupt(\"return\", _context7.sent);\n\n                          case 3:\n                          case \"end\":\n                            return _context7.stop();\n                        }\n                      }\n                    }, _callee7);\n                  }));\n\n                  return function (_x7) {\n                    return _ref7.apply(this, arguments);\n                  };\n                }()));\n\n              case 33:\n                betsData.acceptedBets = _context8.sent;\n                _context8.next = 39;\n                break;\n\n              case 36:\n                _context8.prev = 36;\n                _context8.t0 = _context8[\"catch\"](3);\n                console.log(_context8.t0.message);\n\n              case 39:\n                dispatch({\n                  type: \"INIT\",\n                  bets: betsData,\n                  userBets: userBets,\n                  initialized: true\n                });\n\n              case 40:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, null, [[3, 36]]);\n      }));\n      return _betEventFinder.apply(this, arguments);\n    }\n\n    betEventFinder();\n  }, []);\n  useEffect(function () {\n    function handlingOpenGames() {\n      return _handlingOpenGames.apply(this, arguments);\n    }\n\n    function _handlingOpenGames() {\n      _handlingOpenGames = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n        var betsData, res;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.prev = 0;\n                _context9.next = 3;\n                return axios.post(\"/api/completedBets?type=open\", completedOpenBets);\n\n              case 3:\n                res = _context9.sent;\n                console.log(\"completedOpenBets\", res);\n                betsData = res.data.map(function (bet) {\n                  var event = completedOpenBets.find(function (acptBet) {\n                    return acptBet.event.id === bet.details.gameId;\n                  });\n                  return _objectSpread(_objectSpread({}, bet), {}, {\n                    event: event.event\n                  });\n                });\n                dispatch({\n                  type: \"COMPLETED OPEN BET\",\n                  bets: betsData\n                });\n                _context9.next = 12;\n                break;\n\n              case 9:\n                _context9.prev = 9;\n                _context9.t0 = _context9[\"catch\"](0);\n                console.log(_context9.t0.message);\n\n              case 12:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, null, [[0, 9]]);\n      }));\n      return _handlingOpenGames.apply(this, arguments);\n    }\n\n    if (completedOpenBets.length > 0) handlingOpenGames();\n  }, [completedOpenBets]);\n  useEffect(function () {\n    function handlingRecipientGames() {\n      return _handlingRecipientGames.apply(this, arguments);\n    }\n\n    function _handlingRecipientGames() {\n      _handlingRecipientGames = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n        var betsData, res;\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _context10.prev = 0;\n                _context10.next = 3;\n                return axios.post(\"/api/completedBets?type=recipient\", completedRecipientBets);\n\n              case 3:\n                res = _context10.sent;\n                console.log(\"completedRecipientBets\", res);\n                betsData = res.data.map(function (bet) {\n                  var event = completedRecipientBets.find(function (acptBet) {\n                    return acptBet.event.id === bet.details.gameId;\n                  });\n                  return _objectSpread(_objectSpread({}, bet), {}, {\n                    event: event.event\n                  });\n                });\n                dispatch({\n                  type: \"COMPLETED RECIPIENT BET\",\n                  bets: betsData\n                });\n                _context10.next = 12;\n                break;\n\n              case 9:\n                _context10.prev = 9;\n                _context10.t0 = _context10[\"catch\"](0);\n                console.log(_context10.t0.message);\n\n              case 12:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, null, [[0, 9]]);\n      }));\n      return _handlingRecipientGames.apply(this, arguments);\n    }\n\n    if (completedRecipientBets.length > 0) handlingRecipientGames();\n  }, [completedRecipientBets]);\n  useEffect(function () {\n    function handlingAcceptedGames() {\n      return _handlingAcceptedGames.apply(this, arguments);\n    }\n\n    function _handlingAcceptedGames() {\n      _handlingAcceptedGames = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {\n        var betsData, res;\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.prev = 0;\n                _context11.next = 3;\n                return axios.post(\"/api/completedBets?type=accepted\", completedAcceptedBets);\n\n              case 3:\n                res = _context11.sent;\n                console.log(\"completedAcceptedBets\", res);\n                betsData = res.data.map(function (bet) {\n                  var event = completedAcceptedBets.find(function (acptBet) {\n                    return acptBet.event.id === bet.details.gameId;\n                  });\n                  return _objectSpread(_objectSpread({}, bet), {}, {\n                    event: event.event\n                  });\n                });\n                dispatch({\n                  type: \"COMPLETED ACCEPTED BET\",\n                  bets: betsData\n                });\n                blockchainDispatch({\n                  type: \"ADD PENDING\",\n                  bets: betsData\n                });\n                _context11.next = 13;\n                break;\n\n              case 10:\n                _context11.prev = 10;\n                _context11.t0 = _context11[\"catch\"](0);\n                console.log(_context11.t0.message);\n\n              case 13:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, null, [[0, 10]]);\n      }));\n      return _handlingAcceptedGames.apply(this, arguments);\n    }\n\n    if (completedAcceptedBets.length > 0) handlingAcceptedGames();\n  }, [completedAcceptedBets]); // useEffect(() => {\n  // \tif (bets.initialized) dispatch({ type: \"GAME UPDATE\", games: sportsData });\n  // }, [sportsData]);\n  // console.log(\"in Bets.Context\", bets);\n  // console.log(\"completedAcceptedBets\", completedAcceptedBets);\n  // console.log(\"completedOpenBets\", completedOpenBets);\n  // console.log(\"completedRecipientBets\", completedRecipientBets);\n\n  return /*#__PURE__*/_jsxDEV(BetContext.Provider, {\n    value: bets,\n    children: /*#__PURE__*/_jsxDEV(BetDispatch.Provider, {\n      value: dispatch,\n      children: props.children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 160,\n    columnNumber: 3\n  }, this);\n}\n\n_s(BetProvider, \"j/tAFeCkWvR/Vq9qK71FQj6uy3g=\");\n\n_c = BetProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"BetProvider\");","map":{"version":3,"sources":["/Users/colechalland/Projects/ChalkCoin/contexts/Bets.Context.js"],"names":["createContext","useReducer","useEffect","useContext","axios","betsReducer","EventsFinder","BlockchainDispatch","getSession","BetContext","BetDispatch","BetProvider","props","blockchainDispatch","pendingBets","openBets","recipientBets","acceptedBets","completedBets","initialized","userBets","bets","dispatch","completedAcceptedBets","map","sport","filter","bet","event","status","type","name","flat","completedOpenBets","completedRecipientBets","betEventFinder","session","get","userRes","data","Promise","all","league","res","betsData","console","log","message","handlingOpenGames","post","find","acptBet","id","details","gameId","length","handlingRecipientGames","handlingAcceptedGames","children"],"mappings":";;;;;;;;;;;;AAAA,SAASA,aAAT,EAAwBC,UAAxB,EAAoCC,SAApC,EAA+CC,UAA/C,QAAiE,OAAjE;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,SAASC,YAAT,QAA6B,yBAA7B;AACA,SAASC,kBAAT,QAAmC,sBAAnC;AACA,SAASC,UAAT,QAA2B,kBAA3B;AAEA,OAAO,IAAMC,UAAU,gBAAGT,aAAa,EAAhC;AACP,OAAO,IAAMU,WAAW,gBAAGV,aAAa,EAAjC;AACP,OAAO,SAASW,WAAT,CAAqBC,KAArB,EAA4B;AAAA;;AAClC,MAAMC,kBAAkB,GAAGV,UAAU,CAACI,kBAAD,CAArC;;AADkC,oBAETN,UAAU,CAACI,WAAD,EAAc;AAChDS,IAAAA,WAAW,EAAE;AAAEC,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,aAAa,EAAE;AAA/B,KADmC;AAEhDC,IAAAA,YAAY,EAAE,EAFkC;AAGhDC,IAAAA,aAAa,EAAE,EAHiC;AAIhDC,IAAAA,WAAW,EAAE,KAJmC;AAKhDC,IAAAA,QAAQ,EAAE;AALsC,GAAd,CAFD;AAAA,MAE3BC,IAF2B;AAAA,MAErBC,QAFqB;;AASlC,MAAMC,qBAAqB,GAAGF,IAAI,CAACJ,YAAL,CAC5BO,GAD4B,CACxB,UAACC,KAAD,EAAW;AAAA;;AACf,0BAAOA,KAAK,CAACJ,IAAb,gDAAO,YAAYK,MAAZ,CAAmB,UAACC,GAAD,EAAS;AAAA;;AAClC,aAAO,eAAAA,GAAG,CAACC,KAAJ,0DAAWC,MAAX,CAAkBC,IAAlB,CAAuBC,IAAvB,MAAgC,cAAvC;AACA,KAFM,CAAP;AAGA,GAL4B,EAM5BC,IAN4B,EAA9B;AAOA,MAAMC,iBAAiB,GAAGZ,IAAI,CAACP,WAAL,CAAiBC,QAAjB,CACxBS,GADwB,CACpB,UAACC,KAAD,EAAW;AAAA;;AACf,2BAAOA,KAAK,CAACJ,IAAb,iDAAO,aAAYK,MAAZ,CAAmB,UAACC,GAAD,EAAS;AAAA;;AAClC,aAAO,gBAAAA,GAAG,CAACC,KAAJ,4DAAWC,MAAX,CAAkBC,IAAlB,CAAuBC,IAAvB,MAAgC,cAAvC;AACA,KAFM,CAAP;AAGA,GALwB,EAMxBC,IANwB,EAA1B;AAOA,MAAME,sBAAsB,GAAGb,IAAI,CAACP,WAAL,CAAiBE,aAAjB,CAC7BQ,GAD6B,CACzB,UAACC,KAAD,EAAW;AAAA;;AACf,2BAAOA,KAAK,CAACJ,IAAb,iDAAO,aAAYK,MAAZ,CAAmB,UAACC,GAAD,EAAS;AAAA;;AAClC,aAAO,gBAAAA,GAAG,CAACC,KAAJ,4DAAWC,MAAX,CAAkBC,IAAlB,CAAuBC,IAAvB,MAAgC,cAAvC;AACA,KAFM,CAAP;AAGA,GAL6B,EAM7BC,IAN6B,EAA/B;AAQA9B,EAAAA,SAAS,CAAC,YAAM;AAAA,aACAiC,cADA;AAAA;AAAA;;AAAA;AAAA,iFACf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEqB3B,UAAU,EAF/B;;AAAA;AAEK4B,gBAAAA,OAFL;AAAA;;AAAA,qBAIMA,OAJN;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAKyBhC,KAAK,CAACiC,GAAN,8BALzB;;AAAA;AAKSC,gBAAAA,OALT;AAMGlB,gBAAAA,QAAQ,GAAGkB,OAAO,CAACC,IAAnB;AANH;AAAA,uBAOyCC,OAAO,CAACC,GAAR,CACrCrB,QAAQ,CAACN,WAAT,CAAqBC,QAArB,CAA8BS,GAA9B;AAAA,sFAAkC,iBAAOkB,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCACpBpC,YAAY,CAACoC,MAAD,EAAS,QAAT,CADQ;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAlC;;AAAA;AAAA;AAAA;AAAA,oBADqC,CAPzC;;AAAA;AAOGtB,gBAAAA,QAAQ,CAACN,WAAT,CAAqBC,QAPxB;AAAA;AAAA,uBAY8CyB,OAAO,CAACC,GAAR,CAC1CrB,QAAQ,CAACN,WAAT,CAAqBE,aAArB,CAAmCQ,GAAnC;AAAA,uFAAuC,kBAAOkB,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCACzBpC,YAAY,CAACoC,MAAD,EAAS,QAAT,CADa;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAvC;;AAAA;AAAA;AAAA;AAAA,oBAD0C,CAZ9C;;AAAA;AAYGtB,gBAAAA,QAAQ,CAACN,WAAT,CAAqBE,aAZxB;AAAA;AAAA,uBAiBiCwB,OAAO,CAACC,GAAR,CAC7BrB,QAAQ,CAACH,YAAT,CAAsBO,GAAtB;AAAA,uFAA0B,kBAAOkB,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCACZpC,YAAY,CAACoC,MAAD,EAAS,QAAT,CADA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAA1B;;AAAA;AAAA;AAAA;AAAA,oBAD6B,CAjBjC;;AAAA;AAiBGtB,gBAAAA,QAAQ,CAACH,YAjBZ;AAAA;AAAA,uBAsBkCuB,OAAO,CAACC,GAAR,CAC9BrB,QAAQ,CAACF,aAAT,CAAuBM,GAAvB;AAAA,uFAA2B,kBAAOkB,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCACbpC,YAAY,CAACoC,MAAD,EAAS,QAAT,CADC;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAA3B;;AAAA;AAAA;AAAA;AAAA,oBAD8B,CAtBlC;;AAAA;AAsBGtB,gBAAAA,QAAQ,CAACF,aAtBZ;;AAAA;AAAA;AAAA,uBA4BoBd,KAAK,CAACiC,GAAN,sBA5BpB;;AAAA;AA4BQM,gBAAAA,GA5BR;AA6BEC,gBAAAA,QAAQ,GAAGD,GAAG,CAACJ,IAAf;AA7BF;AAAA,uBA8BwCC,OAAO,CAACC,GAAR,CACrCG,QAAQ,CAAC9B,WAAT,CAAqBC,QAArB,CAA8BS,GAA9B;AAAA,uFAAkC,kBAAOkB,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCACpBpC,YAAY,CAACoC,MAAD,EAAS,QAAT,CADQ;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAlC;;AAAA;AAAA;AAAA;AAAA,oBADqC,CA9BxC;;AAAA;AA8BEE,gBAAAA,QAAQ,CAAC9B,WAAT,CAAqBC,QA9BvB;AAAA;AAAA,uBAmC6CyB,OAAO,CAACC,GAAR,CAC1CG,QAAQ,CAAC9B,WAAT,CAAqBE,aAArB,CAAmCQ,GAAnC;AAAA,uFAAuC,kBAAOkB,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCACzBpC,YAAY,CAACoC,MAAD,EAAS,QAAT,CADa;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAvC;;AAAA;AAAA;AAAA;AAAA,oBAD0C,CAnC7C;;AAAA;AAmCEE,gBAAAA,QAAQ,CAAC9B,WAAT,CAAqBE,aAnCvB;AAAA;AAAA,uBAwCgCwB,OAAO,CAACC,GAAR,CAC7BG,QAAQ,CAAC3B,YAAT,CAAsBO,GAAtB;AAAA,uFAA0B,kBAAOkB,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCACZpC,YAAY,CAACoC,MAAD,EAAS,QAAT,CADA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAA1B;;AAAA;AAAA;AAAA;AAAA,oBAD6B,CAxChC;;AAAA;AAwCEE,gBAAAA,QAAQ,CAAC3B,YAxCX;AAAA;AAAA;;AAAA;AAAA;AAAA;AA8CE4B,gBAAAA,OAAO,CAACC,GAAR,CAAY,aAAIC,OAAhB;;AA9CF;AAgDCzB,gBAAAA,QAAQ,CAAC;AAAEQ,kBAAAA,IAAI,EAAE,MAAR;AAAgBT,kBAAAA,IAAI,EAAEuB,QAAtB;AAAgCxB,kBAAAA,QAAQ,EAARA,QAAhC;AAA0CD,kBAAAA,WAAW,EAAE;AAAvD,iBAAD,CAAR;;AAhDD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADe;AAAA;AAAA;;AAmDfgB,IAAAA,cAAc;AACd,GApDQ,EAoDN,EApDM,CAAT;AAsDAjC,EAAAA,SAAS,CAAC,YAAM;AAAA,aACA8C,iBADA;AAAA;AAAA;;AAAA;AAAA,oFACf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAGoB5C,KAAK,CAAC6C,IAAN,iCAA2ChB,iBAA3C,CAHpB;;AAAA;AAGQU,gBAAAA,GAHR;AAIEE,gBAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCH,GAAjC;AACAC,gBAAAA,QAAQ,GAAGD,GAAG,CAACJ,IAAJ,CAASf,GAAT,CAAa,UAACG,GAAD,EAAS;AAChC,sBAAMC,KAAK,GAAGK,iBAAiB,CAACiB,IAAlB,CAAuB,UAACC,OAAD;AAAA,2BAAaA,OAAO,CAACvB,KAAR,CAAcwB,EAAd,KAAqBzB,GAAG,CAAC0B,OAAJ,CAAYC,MAA9C;AAAA,mBAAvB,CAAd;AACA,yDAAY3B,GAAZ;AAAiBC,oBAAAA,KAAK,EAAEA,KAAK,CAACA;AAA9B;AACA,iBAHU,CAAX;AAIAN,gBAAAA,QAAQ,CAAC;AAAEQ,kBAAAA,IAAI,EAAE,oBAAR;AAA8BT,kBAAAA,IAAI,EAAEuB;AAApC,iBAAD,CAAR;AATF;AAAA;;AAAA;AAAA;AAAA;AAWEC,gBAAAA,OAAO,CAACC,GAAR,CAAY,aAAIC,OAAhB;;AAXF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADe;AAAA;AAAA;;AAef,QAAId,iBAAiB,CAACsB,MAAlB,GAA2B,CAA/B,EAAkCP,iBAAiB;AACnD,GAhBQ,EAgBN,CAACf,iBAAD,CAhBM,CAAT;AAkBA/B,EAAAA,SAAS,CAAC,YAAM;AAAA,aACAsD,sBADA;AAAA;AAAA;;AAAA;AAAA,yFACf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAGoBpD,KAAK,CAAC6C,IAAN,sCAAgDf,sBAAhD,CAHpB;;AAAA;AAGQS,gBAAAA,GAHR;AAIEE,gBAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCH,GAAtC;AACAC,gBAAAA,QAAQ,GAAGD,GAAG,CAACJ,IAAJ,CAASf,GAAT,CAAa,UAACG,GAAD,EAAS;AAChC,sBAAMC,KAAK,GAAGM,sBAAsB,CAACgB,IAAvB,CAA4B,UAACC,OAAD;AAAA,2BAAaA,OAAO,CAACvB,KAAR,CAAcwB,EAAd,KAAqBzB,GAAG,CAAC0B,OAAJ,CAAYC,MAA9C;AAAA,mBAA5B,CAAd;AACA,yDAAY3B,GAAZ;AAAiBC,oBAAAA,KAAK,EAAEA,KAAK,CAACA;AAA9B;AACA,iBAHU,CAAX;AAIAN,gBAAAA,QAAQ,CAAC;AAAEQ,kBAAAA,IAAI,EAAE,yBAAR;AAAmCT,kBAAAA,IAAI,EAAEuB;AAAzC,iBAAD,CAAR;AATF;AAAA;;AAAA;AAAA;AAAA;AAWEC,gBAAAA,OAAO,CAACC,GAAR,CAAY,cAAIC,OAAhB;;AAXF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADe;AAAA;AAAA;;AAef,QAAIb,sBAAsB,CAACqB,MAAvB,GAAgC,CAApC,EAAuCC,sBAAsB;AAC7D,GAhBQ,EAgBN,CAACtB,sBAAD,CAhBM,CAAT;AAkBAhC,EAAAA,SAAS,CAAC,YAAM;AAAA,aACAuD,qBADA;AAAA;AAAA;;AAAA;AAAA,wFACf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAGoBrD,KAAK,CAAC6C,IAAN,qCAA+C1B,qBAA/C,CAHpB;;AAAA;AAGQoB,gBAAAA,GAHR;AAIEE,gBAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAAqCH,GAArC;AACAC,gBAAAA,QAAQ,GAAGD,GAAG,CAACJ,IAAJ,CAASf,GAAT,CAAa,UAACG,GAAD,EAAS;AAChC,sBAAMC,KAAK,GAAGL,qBAAqB,CAAC2B,IAAtB,CAA2B,UAACC,OAAD;AAAA,2BAAaA,OAAO,CAACvB,KAAR,CAAcwB,EAAd,KAAqBzB,GAAG,CAAC0B,OAAJ,CAAYC,MAA9C;AAAA,mBAA3B,CAAd;AACA,yDAAY3B,GAAZ;AAAiBC,oBAAAA,KAAK,EAAEA,KAAK,CAACA;AAA9B;AACA,iBAHU,CAAX;AAIAN,gBAAAA,QAAQ,CAAC;AAAEQ,kBAAAA,IAAI,EAAE,wBAAR;AAAkCT,kBAAAA,IAAI,EAAEuB;AAAxC,iBAAD,CAAR;AACA/B,gBAAAA,kBAAkB,CAAC;AAAEiB,kBAAAA,IAAI,EAAE,aAAR;AAAuBT,kBAAAA,IAAI,EAAEuB;AAA7B,iBAAD,CAAlB;AAVF;AAAA;;AAAA;AAAA;AAAA;AAYEC,gBAAAA,OAAO,CAACC,GAAR,CAAY,cAAIC,OAAhB;;AAZF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADe;AAAA;AAAA;;AAgBf,QAAIxB,qBAAqB,CAACgC,MAAtB,GAA+B,CAAnC,EAAsCE,qBAAqB;AAC3D,GAjBQ,EAiBN,CAAClC,qBAAD,CAjBM,CAAT,CAzHkC,CA4IlC;AACA;AACA;AAEA;AACA;AACA;AACA;;AAEA,sBACC,QAAC,UAAD,CAAY,QAAZ;AAAqB,IAAA,KAAK,EAAEF,IAA5B;AAAA,2BACC,QAAC,WAAD,CAAa,QAAb;AAAsB,MAAA,KAAK,EAAEC,QAA7B;AAAA,gBAAwCV,KAAK,CAAC8C;AAA9C;AAAA;AAAA;AAAA;AAAA;AADD;AAAA;AAAA;AAAA;AAAA,UADD;AAKA;;GA1Je/C,W;;KAAAA,W","sourcesContent":["import { createContext, useReducer, useEffect, useContext } from \"react\";\nimport axios from \"axios\";\nimport betsReducer from \"../reducers/Bets.Reducer\";\nimport { EventsFinder } from \"../helpers/EventsHelper\";\nimport { BlockchainDispatch } from \"./Blockchain.Context\";\nimport { getSession } from \"next-auth/client\";\n\nexport const BetContext = createContext();\nexport const BetDispatch = createContext();\nexport function BetProvider(props) {\n\tconst blockchainDispatch = useContext(BlockchainDispatch);\n\tconst [bets, dispatch] = useReducer(betsReducer, {\n\t\tpendingBets: { openBets: [], recipientBets: [] },\n\t\tacceptedBets: [],\n\t\tcompletedBets: [],\n\t\tinitialized: false,\n\t\tuserBets: {},\n\t});\n\tconst completedAcceptedBets = bets.acceptedBets\n\t\t.map((sport) => {\n\t\t\treturn sport.bets?.filter((bet) => {\n\t\t\t\treturn bet.event?.status.type.name === \"STATUS_FINAL\";\n\t\t\t});\n\t\t})\n\t\t.flat();\n\tconst completedOpenBets = bets.pendingBets.openBets\n\t\t.map((sport) => {\n\t\t\treturn sport.bets?.filter((bet) => {\n\t\t\t\treturn bet.event?.status.type.name === \"STATUS_FINAL\";\n\t\t\t});\n\t\t})\n\t\t.flat();\n\tconst completedRecipientBets = bets.pendingBets.recipientBets\n\t\t.map((sport) => {\n\t\t\treturn sport.bets?.filter((bet) => {\n\t\t\t\treturn bet.event?.status.type.name === \"STATUS_FINAL\";\n\t\t\t});\n\t\t})\n\t\t.flat();\n\n\tuseEffect(() => {\n\t\tasync function betEventFinder() {\n\t\t\tlet betsData, userBets;\n\t\t\tlet session = await getSession();\n\t\t\ttry {\n\t\t\t\tif (session) {\n\t\t\t\t\tconst userRes = await axios.get(`/api/bets?type=currentUser`);\n\t\t\t\t\tuserBets = userRes.data;\n\t\t\t\t\tuserBets.pendingBets.openBets = await Promise.all(\n\t\t\t\t\t\tuserBets.pendingBets.openBets.map(async (league) => {\n\t\t\t\t\t\t\treturn await EventsFinder(league, \"league\");\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t\tuserBets.pendingBets.recipientBets = await Promise.all(\n\t\t\t\t\t\tuserBets.pendingBets.recipientBets.map(async (league) => {\n\t\t\t\t\t\t\treturn await EventsFinder(league, \"league\");\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t\tuserBets.acceptedBets = await Promise.all(\n\t\t\t\t\t\tuserBets.acceptedBets.map(async (league) => {\n\t\t\t\t\t\t\treturn await EventsFinder(league, \"league\");\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t\tuserBets.completedBets = await Promise.all(\n\t\t\t\t\t\tuserBets.completedBets.map(async (league) => {\n\t\t\t\t\t\t\treturn await EventsFinder(league, \"league\");\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tconst res = await axios.get(`/api/bets?type=all`);\n\t\t\t\tbetsData = res.data;\n\t\t\t\tbetsData.pendingBets.openBets = await Promise.all(\n\t\t\t\t\tbetsData.pendingBets.openBets.map(async (league) => {\n\t\t\t\t\t\treturn await EventsFinder(league, \"league\");\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\tbetsData.pendingBets.recipientBets = await Promise.all(\n\t\t\t\t\tbetsData.pendingBets.recipientBets.map(async (league) => {\n\t\t\t\t\t\treturn await EventsFinder(league, \"league\");\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\tbetsData.acceptedBets = await Promise.all(\n\t\t\t\t\tbetsData.acceptedBets.map(async (league) => {\n\t\t\t\t\t\treturn await EventsFinder(league, \"league\");\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err.message);\n\t\t\t}\n\t\t\tdispatch({ type: \"INIT\", bets: betsData, userBets, initialized: true });\n\t\t}\n\t\tbetEventFinder();\n\t}, []);\n\n\tuseEffect(() => {\n\t\tasync function handlingOpenGames() {\n\t\t\tlet betsData;\n\t\t\ttry {\n\t\t\t\tconst res = await axios.post(`/api/completedBets?type=open`, completedOpenBets);\n\t\t\t\tconsole.log(\"completedOpenBets\", res);\n\t\t\t\tbetsData = res.data.map((bet) => {\n\t\t\t\t\tconst event = completedOpenBets.find((acptBet) => acptBet.event.id === bet.details.gameId);\n\t\t\t\t\treturn { ...bet, event: event.event };\n\t\t\t\t});\n\t\t\t\tdispatch({ type: \"COMPLETED OPEN BET\", bets: betsData });\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err.message);\n\t\t\t}\n\t\t}\n\t\tif (completedOpenBets.length > 0) handlingOpenGames();\n\t}, [completedOpenBets]);\n\n\tuseEffect(() => {\n\t\tasync function handlingRecipientGames() {\n\t\t\tlet betsData;\n\t\t\ttry {\n\t\t\t\tconst res = await axios.post(`/api/completedBets?type=recipient`, completedRecipientBets);\n\t\t\t\tconsole.log(\"completedRecipientBets\", res);\n\t\t\t\tbetsData = res.data.map((bet) => {\n\t\t\t\t\tconst event = completedRecipientBets.find((acptBet) => acptBet.event.id === bet.details.gameId);\n\t\t\t\t\treturn { ...bet, event: event.event };\n\t\t\t\t});\n\t\t\t\tdispatch({ type: \"COMPLETED RECIPIENT BET\", bets: betsData });\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err.message);\n\t\t\t}\n\t\t}\n\t\tif (completedRecipientBets.length > 0) handlingRecipientGames();\n\t}, [completedRecipientBets]);\n\n\tuseEffect(() => {\n\t\tasync function handlingAcceptedGames() {\n\t\t\tlet betsData;\n\t\t\ttry {\n\t\t\t\tconst res = await axios.post(`/api/completedBets?type=accepted`, completedAcceptedBets);\n\t\t\t\tconsole.log(\"completedAcceptedBets\", res);\n\t\t\t\tbetsData = res.data.map((bet) => {\n\t\t\t\t\tconst event = completedAcceptedBets.find((acptBet) => acptBet.event.id === bet.details.gameId);\n\t\t\t\t\treturn { ...bet, event: event.event };\n\t\t\t\t});\n\t\t\t\tdispatch({ type: \"COMPLETED ACCEPTED BET\", bets: betsData });\n\t\t\t\tblockchainDispatch({ type: \"ADD PENDING\", bets: betsData });\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err.message);\n\t\t\t}\n\t\t}\n\t\tif (completedAcceptedBets.length > 0) handlingAcceptedGames();\n\t}, [completedAcceptedBets]);\n\n\t// useEffect(() => {\n\t// \tif (bets.initialized) dispatch({ type: \"GAME UPDATE\", games: sportsData });\n\t// }, [sportsData]);\n\n\t// console.log(\"in Bets.Context\", bets);\n\t// console.log(\"completedAcceptedBets\", completedAcceptedBets);\n\t// console.log(\"completedOpenBets\", completedOpenBets);\n\t// console.log(\"completedRecipientBets\", completedRecipientBets);\n\n\treturn (\n\t\t<BetContext.Provider value={bets}>\n\t\t\t<BetDispatch.Provider value={dispatch}>{props.children}</BetDispatch.Provider>\n\t\t</BetContext.Provider>\n\t);\n}\n"]},"metadata":{},"sourceType":"module"}